import numpy, scipy.io
from numpy import *
from numpy import pi
from numpy import linalg
from numpy.linalg import norm
from numpy.numarray import array, zeros, dot, Float64, sqrt
from matplotlib import rc
from numpy import arange, cos, pi
from matplotlib.pyplot import loglog,figure,semilogy, semilogx,axes, plot, subplot, xlabel, ylabel, title,show,legend,grid,xticks,yticks
rc('text', usetex=True)
rc('font', family='serif')
time=  array([ 0.,          0.00620204 , 0.02579796,  0.04 ,       0.04620204,  0.06579796,
  0.08,        0.08620204,  0.10579796,  0.12 ,       0.12620204 , 0.14579796,
  0.16 ,       0.16620204,  0.18579796,  0.2   ,      0.20620204 , 0.22579796,
  0.24  ,      0.24620204,  0.26579796,  0.28   ,     0.28620204 , 0.30579796,
  0.32   ,     0.32620204,  0.34579796,  0.36,        0.36620204 , 0.38579796,
  0.4     ,    0.40620204,  0.42579796,  0.44,        0.44620204 , 0.46579796,
  0.48 ,       0.48620204,  0.50579796,  0.52 ,       0.52620204 , 0.54579796,
  0.56 ,       0.56620204,  0.58579796,  0.6   ,      0.60620204 , 0.62579796,
  0.64 ,       0.64620204,  0.66579796,  0.68   ,     0.68620204 , 0.70579796,
  0.72 ,       0.72620204,  0.74579796,  0.76    ,    0.76620204 , 0.78579796,
  0.8  ,       0.80620204,  0.82579796,  0.84     ,   0.84620204 , 0.86579796,
  0.88 ,       0.88620204,  0.90579796,  0.92 ,       0.92620204 , 0.94579796,
  0.96 ,       0.96620204,  0.98579796,  1.    ,      1.00620204 , 1.02579796,
  1.04 ,       1.04620204,  1.06579796,  1.08,        1.08620204 , 1.10579796,
  1.12 ,       1.12620204,  1.14579796,  1.16 ,       1.16620204 , 1.18579796,
  1.2,         1.20620204 , 1.22579796,  1.24  ,      1.24620204 , 1.26579796,
  1.28,        1.28620204 , 1.30579796,  1.32   ,     1.32620204 , 1.34579796,
  1.36 ,       1.36620204,  1.38579796,  1.4     ,    1.40620204 , 1.42579796,
  1.44  ,      1.44620204,  1.46579796,  1.48     ,   1.48620204 , 1.50579796,
  1.52 ,       1.52620204,  1.54579796 , 1.56,        1.56620204 , 1.58579796,
  1.6   ,      1.60620204,  1.62579796,  1.64,        1.64620204 , 1.66579796,
  1.68,        1.68620204,  1.70579796,  1.72 ,       1.72620204 , 1.74579796,
  1.76 ,       1.76620204,  1.78579796,  1.8   ,      1.80620204 , 1.82579796,
  1.84 ,       1.84620204,  1.86579796,  1.88   ,     1.88620204 , 1.90579796,
  1.92 ,       1.92620204 , 1.94579796 , 1.96    ,    1.96620204 , 1.98579796,
  2.        ])
controlfunction= array( [  5.99999998e+01,   6.00000000e+01,   6.00000000e+01,   5.99999993e+01,
   5.99999998e+01,   4.28522692e+01   ,5.99999391e+01   ,2.30013838e+01
   ,3.88917399e+01,   2.60949292e+01   ,3.41780384e+01   ,3.41940245e+01
   ,3.41863651e+01,   3.41842972e+01   ,3.41909495e+01   ,3.41878985e+01
   ,3.41864997e+01,   3.41897015e+01   ,3.41877677e+01   ,3.41879078e+01
   ,3.41889018e+01 ,  3.41877833e+01   ,3.41887726e+01   ,3.41884161e+01
   ,3.41878427e+01,   3.41892729e+01   ,3.41881387e+01   ,3.41878972e+01
   ,3.41895468e+01,   3.41879885e+01   ,3.41879344e+01   ,3.41896903e+01
   ,3.41879102e+01,   3.41879551e+01   ,3.41897643e+01   ,3.41878694e+01
   ,3.41879628e+01,   3.41898050e+01   ,3.41878456e+01   ,3.41879590e+01
   ,3.41898340e+01,   3.41878262e+01   ,3.41879424e+01   ,3.41898664e+01
   ,3.41878015e+01,   3.41879069e+01   ,3.41899170e+01   ,3.41877607e+01
   ,3.41878416e+01,   3.41900047e+01   ,3.41876903e+01   ,3.41877312e+01
   ,3.41901556e+01,   3.41875722e+01   ,3.41875519e+01   ,3.41904102e+01
   ,3.41873796e+01,   3.41872142e+01   ,3.41906223e+01   ,3.41880371e+01
   ,3.41912948e+01   ,3.36537980e+01   ,3.64087283e+01   ,4.51367108e+01
   ,2.58571131e+01   ,5.99999993e+01   ,5.99999990e+01   ,5.99999999e+01
   ,6.00000000e+01   ,5.99999999e+01   ,6.00000000e+01   ,6.00000000e+01
   ,6.00000000e+01   ,6.00000000e+01   ,6.00000000e+01   ,4.33409294e-09
   ,6.15430672e-09   ,7.07321083e-09   ,4.66748709e-09   ,6.75292544e-09
   ,7.54285083e-09   ,4.95012901e-09   ,7.15661600e-09   ,7.82892653e-09
   ,5.15453803e-09   ,7.39887536e-09   ,7.97556546e-09   ,5.25581165e-09
   ,7.50131018e-09   ,8.02242093e-09   ,5.28258648e-09   ,7.52523874e-09
   ,8.02990957e-09   ,5.28734078e-09   ,7.52857512e-09   ,8.03074834e-09
   ,5.28799497e-09   ,7.52924458e-09   ,8.03142388e-09   ,5.28820051e-09
   ,7.52947019e-09   ,8.03124632e-09   ,5.28825648e-09   ,7.52930194e-09
   ,8.03117379e-09   ,5.28872464e-09   ,7.52970846e-09   ,8.03201165e-09
   ,5.29098014e-09   ,7.53122897e-09   ,8.03448452e-09   ,5.29819739e-09
   ,7.53462020e-09   ,8.03864118e-09   ,5.30844944e-09   ,7.53732224e-09
   ,8.04059417e-09   ,5.31268256e-09   ,7.53810900e-09   ,8.04096940e-09
   ,5.31348571e-09   ,7.53826192e-09   ,8.04104049e-09   ,5.31360999e-09
   ,7.53830813e-09   ,8.04106083e-09   ,5.31363292e-09   ,7.53833590e-09
   ,8.04106637e-09   ,5.31364008e-09   ,7.53835679e-09   ,8.04106404e-09
   ,5.31364343e-09   ,7.53837205e-09   ,8.04106065e-09   ,5.31364854e-09
   ,7.53838637e-09   ,8.04107963e-09   ,5.31368947e-09   ,7.53844619e-09
   ,8.04125751e-09   ,5.31402340e-09   ,7.53892405e-09   ,8.04256356e-09
   ,5.31655642e-09   ,7.54264002e-09   ,8.05212011e-09   ,5.33527060e-09
   ,7.57032032e-09   ,8.11913275e-09   ,6.35042237e-09])
statefunction=  array([ -2.58227314e-33   ,3.17182262e-01   ,1.10212153e+00   ,1.54638647e+00
   ,1.76723718e+00   ,2.05490445e+00   ,2.27037674e+00   ,2.16227874e+00
   ,2.16227471e+00   ,2.16237799e+00   ,2.16227822e+00   ,2.16227840e+00
   ,2.16231874e+00   ,2.16227788e+00   ,2.16227923e+00   ,2.16229791e+00
   ,2.16227761e+00   ,2.16227872e+00   ,2.16228444e+00   ,2.16227738e+00
   ,2.16227809e+00   ,2.16227612e+00   ,2.16227722e+00   ,2.16227764e+00
   ,2.16227129e+00   ,2.16227712e+00   ,2.16227737e+00   ,2.16226865e+00
   ,2.16227707e+00   ,2.16227723e+00   ,2.16226726e+00   ,2.16227704e+00
   ,2.16227716e+00   ,2.16226655e+00   ,2.16227702e+00   ,2.16227713e+00
   ,2.16226616e+00   ,2.16227702e+00   ,2.16227711e+00   ,2.16226589e+00
   ,2.16227701e+00   ,2.16227709e+00   ,2.16226559e+00   ,2.16227700e+00
   ,2.16227707e+00   ,2.16226513e+00   ,2.16227698e+00   ,2.16227704e+00
   ,2.16226432e+00   ,2.16227696e+00   ,2.16227697e+00   ,2.16226295e+00
   ,2.16227692e+00   ,2.16227688e+00   ,2.16226069e+00   ,2.16227687e+00
   ,2.16227692e+00   ,2.16225689e+00   ,2.16227677e+00   ,2.16227759e+00
   ,2.16228717e+00   ,2.16227644e+00   ,2.16227435e+00   ,2.24657999e+00
   ,2.13901857e+00   ,2.36837184e+00   ,2.73611501e+00   ,2.87952195e+00
   ,3.31481033e+00   ,3.61585172e+00   ,3.74411631e+00   ,4.13844659e+00
   ,4.41504283e+00   ,4.47808899e+00   ,5.00000004e+00   ,4.89432710e+00
   ,4.63807085e+00   ,3.84553268e+00   ,3.29116424e+00   ,3.05551441e+00
   ,2.34154910e+00   ,1.86119271e+00   ,1.66345680e+00   ,1.09857215e+00
   ,7.58611376e-01   ,6.31017585e-01   ,3.23472039e-01   ,1.82543014e-01
   ,1.39923507e-01   ,5.67020944e-02   ,2.88968283e-02   ,2.14724318e-02
   ,8.00784383e-03   ,4.03612721e-03   ,2.98279555e-03   ,1.09630993e-03
   ,5.52232055e-04   ,4.07796523e-04   ,1.49573729e-04   ,7.53391076e-05
   ,5.56283849e-05   ,2.03979697e-05   ,1.02742845e-05   ,7.58617976e-06
   ,2.78170231e-06   ,1.40117655e-06   ,1.03461128e-06   ,3.79458196e-07
   ,1.91195543e-07   ,1.41208933e-07   ,5.18790013e-08   ,2.61979750e-08
   ,1.93812783e-08   ,7.20916398e-09   ,3.69839820e-09   ,2.76849790e-09
   ,1.11787294e-09   ,6.30319376e-10   ,5.03154748e-10   ,2.87258252e-10
   ,2.11954364e-10   ,1.94251501e-10   ,1.73995626e-10   ,1.54906257e-10
   ,1.52129708e-10   ,1.58551438e-10   ,1.47127400e-10   ,1.46386275e-10
   ,1.56445698e-10   ,1.46066807e-10   ,1.45603311e-10   ,1.56158686e-10
   ,1.45922226e-10   ,1.45496659e-10   ,1.56119616e-10   ,1.45902536e-10
   ,1.45482201e-10   ,1.56114506e-10   ,1.45900260e-10   ,1.45480786e-10
   ,1.56115495e-10   ,1.45903375e-10   ,1.45485310e-10   ,1.56128308e-10
   ,1.45929396e-10   ,1.45522235e-10   ,1.56224280e-10   ,1.46121570e-10
   ,1.46186682e-10   ,1.55987287e-10   ,1.51224694e-10])

scipy.io.savemat('Desktop',mdict={'time':time}

f1=figure()
plot(time,controlfunction,'k',label='Actual Input rate $u(t)$')
legend(loc='best',fontsize=24)
xlabel('Time',fontsize=24)
xticks(fontsize=24)
yticks(fontsize=24)
f2=figure()
plot(time,statefunction,'k',label='Average buffer load $x(t)$')
xlabel('Time',fontsize=14)
xticks(fontsize=14)
yticks(fontsize=14)
legend(loc='best')
show()

