clc
clear
close

A = [-0.1778 0 0 0 0 -9.7807 -9.7807 0 0 0 0;
      0 -0.3104 0 0 9.7807 0 0 9.7807 0 0 0;
      -0.3326 -0.5353 0 0 0 0 75.7640 343.8600 0 0 0;
      -0.1903 -0.2490 0 0 0 0 172.6200 -59.9580 0 0 0;
       0 0 1.0000 0 0 0 0 0 0 0 0;
       0 0 0 1.0000 0 0 0 0 0 0 0;
       0 0 0 -1.0000 0 0 -8.1222 4.6535 0 0 0;
       0 0 -1.0000 0 0 0 -0.0921 -8.1222 0 0 0;
       0 0 0 0 0 0 0 0 -0.6821 -0.0535 0;
       0 0 0 0 0 0 0 0 -0.2892 -5.5561 -36.6740;
       0 0 0 0 0 0 0 0 0 2.7492 -11.1120];
B = [zeros(6,4);
     0.0496 2.6224 0 0;
     2.4928 0.1741 0 0;
     0 0 7.8246 0;
     0 0 1.6349 -58.4053;
     0 0 0 0];
C = [eye(6,11); zeros(2,8) [1 0 0; 0 1 0]];
D = zeros(8,4);
E =[A(:,1),A(:,2),A(:,9)];

t =0:0.1:40;
wind= max(cos(2*pi/40*(t-20)),0);
uwind=10*wind;
vwind=10*wind;
wwind=3*wind;
len=length(t);
z=zeros(len,1);
wind_dis=[t',uwind',vwind',wwind'];
x0 = [1 0 0 0 0 -0.1 0 0 0 0 0]';

sys = ss(A,B,C,D);

Q = eye(11);
R = 0.2*eye(4);
[K,P,E1] = lqr(A,B,Q,R);

Qe = eye(4);
Re = 0.2*eye(8);
[Kest,L,Pe]=kalman(sys,Qe,Re);